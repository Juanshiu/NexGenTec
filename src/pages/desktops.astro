---
import Layout from '../layouts/Layout.astro';
import Checkboxs from '../components/checkboxs.astro';
import { supabase } from "../lib/supabase";
import type Products from "../interface/productos";
import Carrito from '../components/icons/Carrito.astro';
import FormattUrl from '../components/FormattUrl.astro';

const checkboxes = [
    { text: 'Oficina', value: 'opcion1', id: 'checkbox1' },
    { text: 'Gaming', value: 'opcion2', id: 'checkbox2' },
];
const checkboxes2 = [
    { text: 'Intel', value: 'opcion1', id: 'checkbox1' },
    { text: 'AMD', value: 'opcion2', id: 'checkbox2' },
];

const checkboxes3 = [
    { text: '4GB', value: 'opcion1', id: 'checkbox1' },
    { text: '8GB', value: 'opcion2', id: 'checkbox2' },
    { text: '16GB', value: 'opcion3', id: 'checkbox3' },
];

const checkboxes4 = [
    { text: '128GB', value: 'opcion1', id: 'checkbox1' },
    { text: '256GB', value: 'opcion2', id: 'checkbox2' },
    { text: '512GB', value: 'opcion3', id: 'checkbox3' },
];

const checkboxes5 = [
    { text: 'Intel', value: 'opcion1', id: 'checkbox1' },
    { text: 'Nvidia', value: 'opcion2', id: 'checkbox2' },
    { text: 'AMD', value: 'opcion3', id: 'checkbox3' },
];

let { data, error } = await supabase
    .from('Productos')
    .select('*')
    .eq('id_categoria', 2)

    if (error) {
        console.log(error)
    }

let Productos: Products[] = data || []
let numeroDeProductos = Productos.length
---

<Layout title='Laptops'>
    <main class=" 2xl:max-w-6xl xl:max-w-6xl mx-auto mt-8 ">

        <div class=" flex justify-between mb-8 text-lg">
            <span>Filtrar resultados: {numeroDeProductos} Producto(s)</span>
            <span>Ordenar Por: <select name="" id="" class=" border border-black rounded"><option value="">Recomendados</option></select></span>
        </div>

        <section class=" flex gap-12 text-xl">
            <aside class=" w-1/3">
                <div class=" flex justify-between mb-2">
                    <span>Ordenar y filtrar</span>
                    <button class=" hover:text-blue-500 transition-colors">Limpiar todo</button>
                </div>
                <hr>

                <Checkboxs title='Por Categoría' checkboxes={checkboxes} />
    
                <Checkboxs title='Por Procesador' checkboxes={checkboxes2} />

                <Checkboxs title='Por Memoria RAM' checkboxes={checkboxes3} />

                <Checkboxs title='Por Almacenamiento' checkboxes={checkboxes4} />
 
                <Checkboxs title='Por Tarjeta Gráfica' checkboxes={checkboxes5} />

            </aside>

            <article class=" w-4/6 grid grid-cols-3 gap-2">
                {
                    Productos?.map((producto) => (
                        <div class=" border border-gray-200 p-4">

                            <img src={producto.img_producto} alt="" class=" w-full object-cover" />
                            <h3 class=" text-lg font-semibold mt-2">{producto.nombre_producto}</h3>
                            <p class=" text-sm text-gray-500 truncate">{producto.descripcion}</p>
                            <span class=" font-semibold text-lg">${producto.precio}</span>

                            <div class=" flex flex-col justify-between mt-2 gap-2 text-sm">
                                <FormattUrl url={producto.nombre_producto} class="flex justify-center bg-black hover:scale-105 transition-transform font-bold text-white px-4 py-2 rounded">Comprar</FormattUrl>
                                <button class="group relative inline-flex h-9 items-center justify-center overflow-hidden rounded bg-neutral-950 px-6 font-bold text-white">
                                    <span>Agregar al carrito</span>
                                    <div class="w-0 translate-x-[100%] pl-0 opacity-0 transition-all duration-200 group-hover:w-5 group-hover:translate-x-0 group-hover:pl-1 group-hover:opacity-100">
                                        <Carrito class=" stroke-white" />
                                    </div>
                                </button>
                            </div>
                        </div>
                    ))
                }

            </article>
        </section>
        
    </main>
</Layout>